{"version":3,"file":"nets-easy-for-woocommerce.min.js","mappings":"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","sources":["webpack://dibs-easy-for-woocommerce/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://dibs-easy-for-woocommerce/./assets/js/nets-easy-for-woocommerce.js"],"sourcesContent":["export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}","/**\n * @member wcDibsEasy\n *\n */\njQuery( function( $ ) {\n\tif ( typeof wcDibsEasy === 'undefined' ) {\n\t\treturn false;\n\t}\n\t/**\n\t * The main object.\n\t *\n\t * @type {Object} dibsEasyForWoocommerce\n\t */\n\tconst dibsEasyForWoocommerce = {\n\t\tbodyEl: $( 'body' ),\n\t\tpaymentMethodEl: $( 'input[name=\"payment_method\"]' ),\n\t\tdibsCheckout: null,\n\t\tblocked: false,\n\t\tselectAnotherSelector: '#dibs-easy-select-other',\n\t\tcheckoutInitiated: wcDibsEasy.checkoutInitiated,\n\t\tdibsOrderProcessing: false,\n\t\tcheckoutFormSelector: 'form.checkout',\n\t\tstandardWooFields: wcDibsEasy.standard_woo_checkout_fields,\n\t\twooTerms: 'form.checkout #terms',\n\n\t\t/**\n\t\t * Initialize the gateway\n\t\t */\n\t\tinit() {\n\t\t\t$( document ).ready( dibsEasyForWoocommerce.loadDibs );\n\t\t\tdibsEasyForWoocommerce.bodyEl.on(\n\t\t\t\t'change',\n\t\t\t\t'input[name=\"payment_method\"]',\n\t\t\t\tdibsEasyForWoocommerce.maybeChangeToDibsEasy\n\t\t\t);\n\t\t\tdibsEasyForWoocommerce.bodyEl.on(\n\t\t\t\t'click',\n\t\t\t\tdibsEasyForWoocommerce.selectAnotherSelector,\n\t\t\t\tdibsEasyForWoocommerce.changeFromDibsEasy\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Check if DIBS Easy is the selected gateway.\n\t\t */\n\t\tdibsIsSelected() {\n\t\t\tif ( dibsEasyForWoocommerce.paymentMethodEl.length > 0 ) {\n\t\t\t\tdibsEasyForWoocommerce.paymentMethod =\n\t\t\t\t\tdibsEasyForWoocommerce.paymentMethodEl\n\t\t\t\t\t\t.filter( ':checked' )\n\t\t\t\t\t\t.val();\n\t\t\t\tif ( 'dibs_easy' === dibsEasyForWoocommerce.paymentMethod ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t/**\n\t\t * Triggers on document ready.\n\t\t */\n\t\tloadDibs() {\n\t\t\tif ( dibsEasyForWoocommerce.dibsIsSelected() ) {\n\t\t\t\tdibsEasyForWoocommerce.moveExtraCheckoutFields();\n\t\t\t\tdibsEasyForWoocommerce.initDibsCheckout();\n\t\t\t\tdibsEasyForWoocommerce.bodyEl.on( 'update_checkout', dibsEasyForWoocommerce.updateCheckout );\n\t\t\t\tdibsEasyForWoocommerce.bodyEl.on( 'updated_checkout', dibsEasyForWoocommerce.updatedCheckout );\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Triggers after a successful payment.\n\t\t *\n\t\t * @param {Object} response\n\t\t */\n\t\tpaymentCompleted( response ) {\n\t\t\tdibsEasyForWoocommerce.logToFile( `Payment completed is triggered with payment id: ${ response.paymentId }` );\n\t\t\tconst redirectUrl = sessionStorage.getItem( 'redirectNets' );\n\t\t\tif ( redirectUrl ) {\n\t\t\t\twindow.location.href = redirectUrl;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t *  Display login error\n\t\t *\n\t\t * @param {string} message\n\t\t */\n\t\tdisplayMustLoginError( message ) {\n\t\t\tconst mustLoginClass = 'woocommerce-NoticeGroupwoocommerce-NoticeGroup-updateOrderReview';\n\t\t\tconst mustLoginNotice = `<div class=\"${ mustLoginClass }\">\n\t\t\t\t<ul class=\"woocommerce-error\" role=\"alert\">\n\t\t\t\t\t<li>${ message }</li>\n\t\t\t\t</ul>\n\t\t\t</div>`;\n\t\t\tdibsEasyForWoocommerce.checkoutFormSelector.prepend(\n\t\t\t\tmustLoginNotice\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Update WC form if needed\n\t\t *\n\t\t * @param {Object} data\n\t\t */\n\t\tupdateAddress( data ) {\n\t\t\tif ( 'yes' === data.updateNeeded ) {\n\t\t\t\t$( '#billing_country' ).val( data.country );\n\t\t\t\t$( '#shipping_country' ).val( data.country );\n\t\t\t\t$( '#billing_postcode' ).val( data.postCode );\n\t\t\t\t$( '#shipping_postcode' ).val( data.postCode );\n\t\t\t}\n\n\t\t\tif ( 'yes' === data.mustLogin ) {\n\t\t\t\t// Customer might need to log in. Inform customer and freeze DIBS checkout.\n\t\t\t\tdibsEasyForWoocommerce.displayMustLoginError( data.mustLoginMessage );\n\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.freezeCheckout();\n\n\t\t\t\tconst etop =\n\t\t\t\t\tdibsEasyForWoocommerce.checkoutFormSelector.offset().top;\n\t\t\t\t$( 'html, body' ).animate(\n\t\t\t\t\t{\n\t\t\t\t\t\tscrollTop: etop,\n\t\t\t\t\t},\n\t\t\t\t\t1000\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// All good release checkout and trigger update_checkout event\n\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.thawCheckout();\n\t\t\t\t$( document.body ).trigger( 'update_checkout' );\n\t\t\t}\n\t\t},\n\n\t\tupdateCheckout() {\n\t\t\tconsole.log( 'update_checkout' );\n\t\t\tif ( window.Dibs !== undefined ) {\n\t\t\t\t// lock iframe\n\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.freezeCheckout();\n\t\t\t}\n\t\t},\n\t\tupdatedCheckout() {\n\t\t\tconsole.log( 'updated_checkout' );\n\t\t\tif ( window.Dibs !== undefined ) {\n\t\t\t\t// unlock iframe\n\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.thawCheckout();\n\t\t\t\t$( '#dibs-order-review' ).unblock();\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Triggers whenever customer updates address information\n\t\t *\n\t\t * @param {Object} address\n\t\t */\n\t\taddressChanged( address ) {\n\t\t\tdibsEasyForWoocommerce.logToFile( 'Address changed is triggered.' );\n\t\t\tif ( address ) {\n\t\t\t\tconsole.log( 'address-changed' );\n\t\t\t\tconsole.log( address );\n\t\t\t\t$.ajax( {\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tasync: true,\n\t\t\t\t\turl: wcDibsEasy.customer_address_updated_url,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'customer_address_updated',\n\t\t\t\t\t\taddress,\n\t\t\t\t\t\tnonce: wcDibsEasy.nets_checkout_nonce,\n\t\t\t\t\t},\n\t\t\t\t\tsuccess( response ) {},\n\t\t\t\t\terror( response ) {},\n\t\t\t\t\tcomplete( response ) {\n\t\t\t\t\t\tconsole.log( 'COMPLETED' );\n\t\t\t\t\t\tconsole.log( 'customer_address_updated ' );\n\t\t\t\t\t\tconsole.log( response.responseJSON.data );\n\t\t\t\t\t\tdibsEasyForWoocommerce.updateAddress(\n\t\t\t\t\t\t\tresponse.responseJSON.data\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Init Dibs Easy Checkout\n\t\t */\n\t\tinitDibsCheckout() {\n\t\t\t// Constructs a new Checkout object.\n\t\t\tdibsEasyForWoocommerce.dibsCheckout = new Dibs.Checkout( {\n\t\t\t\tcheckoutKey: wcDibsEasy.privateKey,\n\t\t\t\tpaymentId: wcDibsEasy.dibs_payment_id,\n\t\t\t\tcontainerId: 'dibs-complete-checkout',\n\t\t\t\tlanguage: wcDibsEasy.locale,\n\t\t\t} );\n\t\t\tdibsEasyForWoocommerce.dibsCheckout.on(\n\t\t\t\t'pay-initialized',\n\t\t\t\tdibsEasyForWoocommerce.getDibsEasyOrder\n\t\t\t);\n\t\t\tdibsEasyForWoocommerce.dibsCheckout.on(\n\t\t\t\t'payment-completed',\n\t\t\t\tdibsEasyForWoocommerce.paymentCompleted\n\t\t\t);\n\t\t\tdibsEasyForWoocommerce.dibsCheckout.on(\n\t\t\t\t'address-changed',\n\t\t\t\tdibsEasyForWoocommerce.addressChanged\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * Triggers when customer clicks the pay button.\n\t\t * Gets the Nets Easy order and starts the order submission\n\t\t *\n\t\t * @param {string} paymentId\n\t\t */\n\t\tgetDibsEasyOrder( paymentId ) {\n\t\t\tdibsEasyForWoocommerce.dibsOrderProcessing = true;\n\t\t\tdibsEasyForWoocommerce.logToFile( `Pay initialized is triggered with payment id: ${ paymentId }` );\n\t\t\t$( document.body ).trigger( 'dibs_pay_initialized' );\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: true,\n\t\t\t\turl: wcDibsEasy.get_order_data_url,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'payment_success',\n\t\t\t\t\tpaymentId,\n\t\t\t\t\tnonce: wcDibsEasy.nets_checkout_nonce,\n\t\t\t\t},\n\t\t\t\tsuccess( data ) {\n\t\t\t\t\tconsole.log( data );\n\t\t\t\t\tif ( false === data.success ) {\n\t\t\t\t\t\tconsole.log( 'PaymentID already exist in order' );\n\t\t\t\t\t\tconsole.log( data );\n\t\t\t\t\t\tif ( data.data.redirect ) {\n\t\t\t\t\t\t\twindow.location.href = data.data.redirect;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdibsEasyForWoocommerce.setAddressData( data );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror( data ) {\n\t\t\t\t\tconsole.log( data, 'error_data' );\n\t\t\t\t},\n\t\t\t\tcomplete( data ) {},\n\t\t\t} );\n\t\t},\n\t\t/**\n\t\t * Sets the customer data.\n\t\t *\n\t\t * @param {Object} data\n\t\t */\n\t\tsetAddressData( data ) {\n\t\t\tdibsEasyForWoocommerce.logToFile( 'Received \"customer data\" from Nets Easy' );\n\t\t\tconst consumer = data.data.payment.consumer;\n\t\t\tconst { billingAddress, shippingAddress } = consumer;\n\n\t\t\t// billingAddress have country with 3 letters.\n\n\t\t\t// check do we have data\n\t\t\tconst hasBillingData = typeof billingAddress === 'object' && ! Array.isArray( billingAddress );\n\t\t\t// Use shipping data if billing data do not exist.\n\t\t\t$( '#billing_address_1' ).val( hasBillingData ? billingAddress.addressLine1 : shippingAddress.addressLine1 );\n\t\t\t$( '#billing_postcode' ).val( hasBillingData ? billingAddress.postalCode : shippingAddress.postalCode );\n\t\t\t$( '#billing_city' ).val( hasBillingData ? billingAddress.city : shippingAddress.city );\n\t\t\t$( '#billing_country' ).val( shippingAddress.country );\n\n\t\t\t$( '#shipping_address_1' ).val( shippingAddress.addressLine1 );\n\t\t\t$( '#shipping_postcode' ).val( shippingAddress.postalCode );\n\t\t\t$( '#shipping_city' ).val( shippingAddress.city );\n\t\t\t$( '#shipping_country' ).val( shippingAddress.country );\n\n\t\t\tif ( consumer.company.hasOwnProperty( 'name' ) ) {\n\t\t\t\t// B2B purchase\n\t\t\t\tconst company = consumer.company;\n\t\t\t\tconst { firstName, lastName, email, phoneNumber } = company.contactDetails;\n\t\t\t\tconst { prefix, number } = phoneNumber;\n\t\t\t\t$( '#billing_company' ).val( company.name );\n\t\t\t\t$( '#shipping_company' ).val( company.name );\n\t\t\t\t$( '#billing_first_name' ).val( firstName );\n\t\t\t\t$( '#billing_last_name' ).val( lastName );\n\t\t\t\t$( '#shipping_first_name' ).val( firstName );\n\t\t\t\t$( '#shipping_last_name' ).val( lastName );\n\t\t\t\t$( '#billing_email' ).val( email );\n\t\t\t\t$( '#billing_phone' ).val( `${ prefix }${ number }` );\n\t\t\t\t// trigger events for 3rd part plugins.\n\t\t\t\t$( '#billing_country' ).change();\n\t\t\t\t$( '#billing_email' ).change();\n\t\t\t\t$( '#billing_email' ).blur();\n\t\t\t} else {\n\t\t\t\t// B2C purchase\n\t\t\t\tconst { firstName, lastName, email, phoneNumber } = consumer.privatePerson;\n\t\t\t\tconst { prefix, number } = phoneNumber;\n\t\t\t\t$( '#billing_company' ).val( '' );\n\t\t\t\t$( '#shipping_company' ).val( '' );\n\t\t\t\t$( '#billing_first_name' ).val( firstName );\n\t\t\t\t$( '#billing_last_name' ).val( lastName );\n\t\t\t\t$( '#shipping_first_name' ).val( firstName );\n\t\t\t\t$( '#shipping_last_name' ).val( lastName );\n\t\t\t\t$( '#billing_email' ).val( email );\n\t\t\t\t// trigger events for 3rd part plugins.\n\t\t\t\t$( '#billing_email' ).change();\n\t\t\t\t$( '#billing_email' ).blur();\n\t\t\t\t$( '#billing_phone' ).val( `${ prefix }${ number }` );\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line eqeqeq\n\t\t\tif ( shippingAddress.addressLine2 != null ) {\n\t\t\t\t$( '#billing_address_2' ).val(\n\t\t\t\t\tshippingAddress.addressLine2\n\t\t\t\t);\n\t\t\t\t$( '#shipping_address_2' ).val(\n\t\t\t\t\tshippingAddress.addressLine2\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Check Terms checkbox, if it exists\n\t\t\tif ( $( dibsEasyForWoocommerce.wooTerms ).length > 0 ) {\n\t\t\t\t$( dibsEasyForWoocommerce.wooTerms ).prop( 'checked', true );\n\t\t\t}\n\t\t\t$( 'input#ship-to-different-address-checkbox' ).prop( 'checked', true );\n\t\t\tdibsEasyForWoocommerce.submitOrder();\n\t\t},\n\t\t/**\n\t\t * When the customer changes to Dibs Easy from other payment methods.\n\t\t */\n\t\tmaybeChangeToDibsEasy() {\n\t\t\tif ( 'dibs_easy' === $( this ).val() ) {\n\t\t\t\t$( '.woocommerce-info' ).remove();\n\t\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector ).block( {\n\t\t\t\t\tmessage: null,\n\t\t\t\t\toverlayCSS: {\n\t\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\t\topacity: 0.6,\n\t\t\t\t\t},\n\t\t\t\t} );\n\t\t\t\t$.ajax( {\n\t\t\t\t\ttype: 'POST',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tnonce: wcDibsEasy.nets_checkout_nonce,\n\t\t\t\t\t},\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\turl: wcDibsEasy.change_payment_method_url,\n\t\t\t\t\tsuccess( data ) {},\n\t\t\t\t\terror( data ) {},\n\t\t\t\t\tcomplete( data ) {\n\t\t\t\t\t\twindow.location.href = data.responseJSON.data.redirect;\n\t\t\t\t\t},\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Submit the order using the WooCommerce AJAX function.\n\t\t */\n\t\tsubmitOrder() {\n\t\t\t$( '.woocommerce-checkout-review-order-table' ).block( {\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6,\n\t\t\t\t},\n\t\t\t} );\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\turl: wcDibsEasy.submitOrder,\n\t\t\t\tdata: $( 'form.checkout' ).serialize(),\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess( data ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif ( 'success' === data.result ) {\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.logToFile(\n\t\t\t\t\t\t\t\t'Successfully placed order.'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.send(\n\t\t\t\t\t\t\t\t'payment-order-finalized',\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.sessionStorage.setItem( 'redirectNets', data.redirect );\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.dibsCheckout.send(\n\t\t\t\t\t\t\t\t'payment-order-finalized',\n\t\t\t\t\t\t\t\ttrue\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow 'Result failed';\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch ( err ) {\n\t\t\t\t\t\tif ( data.messages ) {\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.logToFile(\n\t\t\t\t\t\t\t\t'Checkout error | ' + data.messages\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.failOrder(\n\t\t\t\t\t\t\t\t'submission',\n\t\t\t\t\t\t\t\tdata.messages\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.logToFile(\n\t\t\t\t\t\t\t\t'Checkout error | No message'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdibsEasyForWoocommerce.failOrder(\n\t\t\t\t\t\t\t\t'submission',\n\t\t\t\t\t\t\t\t'<div class=\"woocommerce-error\">' +\n\t\t\t\t\t\t\t\t\t'Checkout error' +\n\t\t\t\t\t\t\t\t\t'</div>'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror( data ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdibsEasyForWoocommerce.logToFile( 'AJAX error | ' + JSON.stringify( data ) );\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\tdibsEasyForWoocommerce.logToFile( 'AJAX error | Failed to parse error message.' );\n\t\t\t\t\t}\n\t\t\t\t\tdibsEasyForWoocommerce.failOrder( 'ajax-error', '<div class=\"woocommerce-error\">Internal Server Error</div>', );\n\t\t\t\t},\n\t\t\t} );\n\t\t},\n\t\t/**\n\t\t * When the customer changes from Dibs Easy to other payment methods.\n\t\t *\n\t\t * @param {Event} e\n\t\t */\n\t\tchangeFromDibsEasy( e ) {\n\t\t\te.preventDefault();\n\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector ).block( {\n\t\t\t\tmessage: null,\n\t\t\t\toverlayCSS: {\n\t\t\t\t\tbackground: '#fff',\n\t\t\t\t\topacity: 0.6,\n\t\t\t\t},\n\t\t\t} );\n\t\t\t$.ajax( {\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: true,\n\t\t\t\turl: wcDibsEasy.change_payment_method_url,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'dibs_change_payment_method',\n\t\t\t\t\tdibs_easy: false,\n\t\t\t\t\tnonce: wcDibsEasy.nets_checkout_nonce,\n\t\t\t\t},\n\t\t\t\tsuccess( data ) {},\n\t\t\t\terror( data ) {},\n\t\t\t\tcomplete( data ) {\n\t\t\t\t\tconsole.log( 'Change payment method success' );\n\t\t\t\t\tconsole.log( data.responseJSON.data.redirect );\n\t\t\t\t\tdibsEasyForWoocommerce.bodyEl.removeClass( 'dibs-selected' );\n\t\t\t\t\twindow.location.href = data.responseJSON.data.redirect;\n\t\t\t\t},\n\t\t\t} );\n\t\t},\n\t\t/**\n\t\t * Moves all non-standard fields to the extra checkout fields.\n\t\t */\n\t\tmoveExtraCheckoutFields() {\n\t\t\t// Move order comments.\n\t\t\t$( '.woocommerce-additional-fields' ).appendTo(\n\t\t\t\t'#dibs-extra-checkout-fields'\n\t\t\t);\n\n\t\t\tconst form = $(\n\t\t\t\t'form[name=\"checkout\"] input, form[name=\"checkout\"] select, textarea'\n\t\t\t);\n\t\t\tfor ( let i = 0; i < form.length; i++ ) {\n\t\t\t\tconst name = form[ i ].name;\n\t\t\t\tconst fields = dibsEasyForWoocommerce.standardWooFields;\n\t\t\t\t// Check if this is a standard field.\n\t\t\t\tif ( $.inArray( name, fields ) === -1 ) {\n\t\t\t\t\t// This is not a standard Woo field, move to our div.\n\t\t\t\t\t$( 'p#' + name + '_field' ).appendTo(\n\t\t\t\t\t\t'#dibs-extra-checkout-fields'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * Logs the message to the Dibs Easy log in WooCommerce.\n\t\t *\n\t\t * @param {string} message\n\t\t */\n\t\tlogToFile( message ) {\n\t\t\t$.ajax( {\n\t\t\t\turl: wcDibsEasy.log_to_file_url,\n\t\t\t\ttype: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tdata: {\n\t\t\t\t\tmessage,\n\t\t\t\t\tnonce: wcDibsEasy.log_to_file_nonce,\n\t\t\t\t},\n\t\t\t} );\n\t\t},\n\t\t/**\n\t\t * Fails the order with Dibs Easy on a checkout error and timeout.\n\t\t *\n\t\t * @param {string} event\n\t\t * @param {string} errorMessage\n\t\t */\n\t\tfailOrder( event, errorMessage ) {\n\t\t\tconst errorClasses = 'woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout';\n\t\t\tconst errorWrapper = `<div class=\"${ errorClasses }\">${ errorMessage }</div>`;\n\n\t\t\t// Send false and cancel\n\t\t\tdibsEasyForWoocommerce.dibsCheckout.send(\n\t\t\t\t'payment-order-finalized',\n\t\t\t\tfalse\n\t\t\t);\n\t\t\t// Renable the form.\n\t\t\tdibsEasyForWoocommerce.bodyEl.trigger( 'updated_checkout' );\n\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector ).removeClass(\n\t\t\t\t'processing'\n\t\t\t);\n\t\t\t// $( dibsEasyForWoocommerce.checkoutFormSelector ).unblock();\n\t\t\t// $( '.woocommerce-checkout-review-order-table' ).unblock();\n\n\t\t\t// Print error messages, and trigger checkout_error, and scroll to notices.\n\t\t\t$( '.woocommerce-NoticeGroup-checkout,' +\n\t\t\t\t'.woocommerce-error,' +\n\t\t\t\t'.woocommerce-message'\n\t\t\t).remove();\n\n\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector ).prepend( errorWrapper );\n\t\t\t// $( dibsEasyForWoocommerce.checkoutFormSelector )\n\t\t\t// \t.removeClass( 'processing' )\n\t\t\t// \t.unblock();\n\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector )\n\t\t\t\t.find( '.input-text, select, input:checkbox' )\n\t\t\t\t.trigger( 'validate' )\n\t\t\t\t.blur();\n\t\t\t$( document.body ).trigger( 'checkout_error', [ errorMessage ] );\n\t\t\t$( 'html, body' ).animate(\n\t\t\t\t{\n\t\t\t\t\tscrollTop:\n\t\t\t\t\t\t$( dibsEasyForWoocommerce.checkoutFormSelector ).offset()\n\t\t\t\t\t\t\t.top - 100,\n\t\t\t\t},\n\t\t\t\t1000\n\t\t\t);\n\t\t},\n\t};\n\n\tdibsEasyForWoocommerce.init();\n} );\n"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","jQuery","$","wcDibsEasy","dibsEasyForWoocommerce","bodyEl","paymentMethodEl","dibsCheckout","blocked","selectAnotherSelector","checkoutInitiated","dibsOrderProcessing","checkoutFormSelector","standardWooFields","standard_woo_checkout_fields","wooTerms","init","document","ready","loadDibs","on","maybeChangeToDibsEasy","changeFromDibsEasy","dibsIsSelected","length","paymentMethod","filter","val","moveExtraCheckoutFields","initDibsCheckout","updateCheckout","updatedCheckout","paymentCompleted","response","logToFile","paymentId","redirectUrl","sessionStorage","getItem","window","location","href","displayMustLoginError","message","mustLoginNotice","prepend","updateAddress","data","updateNeeded","country","postCode","mustLogin","mustLoginMessage","freezeCheckout","etop","offset","top","animate","scrollTop","thawCheckout","body","trigger","console","log","undefined","Dibs","unblock","addressChanged","address","ajax","type","dataType","async","url","customer_address_updated_url","action","nonce","nets_checkout_nonce","success","error","complete","responseJSON","Checkout","checkoutKey","privateKey","dibs_payment_id","containerId","language","locale","getDibsEasyOrder","get_order_data_url","redirect","setAddressData","consumer","payment","billingAddress","shippingAddress","hasBillingData","Array","isArray","addressLine1","postalCode","city","company","hasOwnProperty","contactDetails","firstName","lastName","email","phoneNumber","prefix","number","name","change","blur","privatePerson","addressLine2","prop","submitOrder","this","remove","block","overlayCSS","background","opacity","change_payment_method_url","serialize","result","send","setItem","err","messages","failOrder","JSON","stringify","e","preventDefault","dibs_easy","removeClass","appendTo","form","i","fields","inArray","log_to_file_url","log_to_file_nonce","event","errorMessage","errorWrapper","find"],"sourceRoot":""}